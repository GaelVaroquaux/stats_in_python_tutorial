<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. Basic statistics &mdash; Statistics in Python</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2015',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <link rel="top" title="Statistics in Python" href="index.html" />
    <link rel="next" title="2. Examples" href="auto_examples/index.html" />
    <link rel="prev" title="Statistics in Python" href="index.html" /> 
  </head>
  <body>
   <!-- Use the header to add javascript -->
    
    <script type="text/javascript">
    // Function to collapse the tip divs
    function collapse_tip_div(obj){
	// Update the representation on the tip div based on whether it
	// has the 'collapsed' css class or not: we only want to
	// collapse divs that are not already collapsed
	if($(obj).hasClass("collapsed")) {
	} else {
	    $(obj).find("p.summary").remove();
	    var content = $(obj).text();
	    var html = $(obj).html();

	    if(content.length > 40) {
		if ($.browser.msie) {
		    // We start at '3' to avoid 'tip', as IE
		    // does not count whitespace
		    var content = content.substr(3, 50);
		} else {
		    // We start at '5' to avoid 'tip '
		    var content = content.substr(5, 50);
		}
	    }
	    $(obj).html('<p class="summary"><img src="_static/plus.png">' + content + '...</p>' + html);
	}
    }
    </script>

    <script type="text/javascript">
    $(function () {
	$(".tip")
	    .click(function(event){
		$(this).toggleClass("collapsed");
		// Change state of the global button
		$('div.related li.transparent').removeClass('transparent')
		$(this).find("p.summary").remove();
		if($(this).hasClass("collapsed")) {
		    var content = $(this).text();
		    var html = $(this).html();
    
		    if(content.length > 40) {
			if ($.browser.msie) {
			    // We start at '3' to avoid 'tip', as IE
			    // does not count whitespace
			    var content = content.substr(3, 50);
			} else {
			    // We start at '5' to avoid 'tip '
			    var content = content.substr(5, 50);
			}
		    }
		    $(this).html('<p class="summary"><img src="_static/plus.png">' + content + '...</p>' + html);
		}
		if (event.target.tagName.toLowerCase() != "a") {
                   return true; //Makes links clickable
		}
	});
    });
    </script>


    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="auto_examples/index.html" title="2. Examples"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="index.html" title="Statistics in Python"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Statistics in Python</a> &raquo;</li>
     
    <!-- Insert a menu in the navigation bar -->
    <li class="left">
	<!-- On click toggle the 'tip' on or off-->
	<a onclick="$('.tip').each(function (index, obj) {
			    collapse_tip_div(obj);
		    });
		    $('.tip').addClass('collapsed');
		    $('.left').addClass('transparent');">
	<img src="_static/minus.png"
         alt="Collapse to compact view" style="padding: 1ex;"/>
	<span class="hiddenlink">Collapse document to compact view</span>
    </a></li>

      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="basic-statistics">
<h1>1. Basic statistics<a class="headerlink" href="#basic-statistics" title="Permalink to this headline">¶</a></h1>
<div class="topic">
<p class="topic-title first"><strong>Prerequisites</strong></p>
<p>This course assumes that you already know Python. The <a class="reference external" href="http://scipy-lectures.github.io">scipy-lectures</a> give an introduction to Python.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">This page gives an introduction to statistics with Python. It is
useful to get acquainted with data representations in Python.</p>
</div>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#interacting-with-data" id="id2">Interacting with data</a></li>
<li><a class="reference internal" href="#hypothesis-testing-two-group-comparisons" id="id3">Hypothesis testing: two-group comparisons</a></li>
<li><a class="reference internal" href="#linear-models-anova" id="id4">Linear models, ANOVA</a></li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="interacting-with-data">
<h2><a class="toc-backref" href="#id2">1.1. Interacting with data</a><a class="headerlink" href="#interacting-with-data" title="Permalink to this headline">¶</a></h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">In this document, the Python prompts are represented with the sign
&#8220;&gt;&gt;&gt;&#8221;. If you need to copy-paste code, you can click on the top right
of the code blocks, to hide the prompts and the outputs.</p>
</div>
<div class="section" id="data-representation-and-vocabulary">
<h3>1.1.1. Data representation and vocabulary<a class="headerlink" href="#data-representation-and-vocabulary" title="Permalink to this headline">¶</a></h3>
<p>The setting that we consider for statistical analysis is that of multiple
<em>observations</em> or <em>samples</em> described by a set of different <em>attributes</em>
or <em>features</em>. The data can than be seen as a 2D table, or matrix, with
columns given the different attributes of the data, and rows the
observations. For instance, the data contained in
<a class="reference download internal" href="_downloads/brain_size.csv"><tt class="xref download docutils literal"><span class="pre">examples/brain_size.csv</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&quot;&quot;</span><span class="p">;</span><span class="s">&quot;Gender&quot;</span><span class="p">;</span><span class="s">&quot;FSIQ&quot;</span><span class="p">;</span><span class="s">&quot;VIQ&quot;</span><span class="p">;</span><span class="s">&quot;PIQ&quot;</span><span class="p">;</span><span class="s">&quot;Weight&quot;</span><span class="p">;</span><span class="s">&quot;Height&quot;</span><span class="p">;</span><span class="s">&quot;MRI_Count&quot;</span>
<div class="newline"></div><span class="s">&quot;1&quot;</span><span class="p">;</span><span class="s">&quot;Female&quot;</span><span class="p">;</span><span class="mi">133</span><span class="p">;</span><span class="mi">132</span><span class="p">;</span><span class="mi">124</span><span class="p">;</span><span class="s">&quot;118&quot;</span><span class="p">;</span><span class="s">&quot;64.5&quot;</span><span class="p">;</span><span class="mi">816932</span>
<div class="newline"></div><span class="s">&quot;2&quot;</span><span class="p">;</span><span class="s">&quot;Male&quot;</span><span class="p">;</span><span class="mi">140</span><span class="p">;</span><span class="mi">150</span><span class="p">;</span><span class="mi">124</span><span class="p">;</span><span class="s">&quot;.&quot;</span><span class="p">;</span><span class="s">&quot;72.5&quot;</span><span class="p">;</span><span class="mi">1001121</span>
<div class="newline"></div><span class="s">&quot;3&quot;</span><span class="p">;</span><span class="s">&quot;Male&quot;</span><span class="p">;</span><span class="mi">139</span><span class="p">;</span><span class="mi">123</span><span class="p">;</span><span class="mi">150</span><span class="p">;</span><span class="s">&quot;143&quot;</span><span class="p">;</span><span class="s">&quot;73.3&quot;</span><span class="p">;</span><span class="mi">1038437</span>
<div class="newline"></div><span class="s">&quot;4&quot;</span><span class="p">;</span><span class="s">&quot;Male&quot;</span><span class="p">;</span><span class="mi">133</span><span class="p">;</span><span class="mi">129</span><span class="p">;</span><span class="mi">128</span><span class="p">;</span><span class="s">&quot;172&quot;</span><span class="p">;</span><span class="s">&quot;68.8&quot;</span><span class="p">;</span><span class="mi">965353</span>
<div class="newline"></div><span class="s">&quot;5&quot;</span><span class="p">;</span><span class="s">&quot;Female&quot;</span><span class="p">;</span><span class="mi">137</span><span class="p">;</span><span class="mi">132</span><span class="p">;</span><span class="mi">134</span><span class="p">;</span><span class="s">&quot;147&quot;</span><span class="p">;</span><span class="s">&quot;65.0&quot;</span><span class="p">;</span><span class="mi">951545</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="the-panda-data-frame">
<h3>1.1.2. The panda data-frame<a class="headerlink" href="#the-panda-data-frame" title="Permalink to this headline">¶</a></h3>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">We will store and manipulate this data in a
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.16.2)"><tt class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></tt></a>, from the <a class="reference external" href="http://pandas.pydata.org">pandas</a> module. It is the Python equivalent of
the spreadsheet table. It is different from a 2D numpy array as it
has named columns, can contained a mixture of different data types by
column, and has elaborate selection and pivotal mechanisms.</p>
</div>
<div class="section" id="reading-data-from-a-csv-file">
<h4>1.1.2.1. Reading data from a CSV file<a class="headerlink" href="#reading-data-from-a-csv-file" title="Permalink to this headline">¶</a></h4>
<div class="sidebar">
<p class="first sidebar-title"><strong>Separator</strong></p>
<p class="last">It is a CSV file, but the separator is &#8221;;&#8221;</p>
</div>
<p>Using the above CSV file that gives observations of brain size and weight
and IQ (Willerman et al. 1991), the data are a mixture of numerical and
categorical values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">&#39;examples/brain_size.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s">&quot;.&quot;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>  
<div class="newline"></div><span class="go">    Unnamed: 0  Gender  FSIQ  VIQ  PIQ  Weight  Height  MRI_Count</span>
<div class="newline"></div><span class="go">0            1  Female   133  132  124     118    64.5     816932</span>
<div class="newline"></div><span class="go">1            2    Male   140  150  124     NaN    72.5    1001121</span>
<div class="newline"></div><span class="go">2            3    Male   139  123  150     143    73.3    1038437</span>
<div class="newline"></div><span class="go">3            4    Male   133  129  128     172    68.8     965353</span>
<div class="newline"></div><span class="go">4            5  Female   137  132  134     147    65.0     951545</span>
<div class="newline"></div><span class="gp">...</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>Missing values</strong></p>
<p class="last">The weight of the second individual is missing in the CSV file. If we
don&#8217;t specify the missing value (NA = not available) marker, we will
not be able to do statistics on the weight.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>    <span class="c"># 40 rows and 8 columns</span>
<div class="newline"></div><span class="go">(40, 8)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>    
<div class="newline"></div><span class="go">Index([u&#39;Unnamed: 0&#39;, u&#39;Gender&#39;, u&#39;FSIQ&#39;, u&#39;VIQ&#39;, u&#39;PIQ&#39;, u&#39;Weight&#39;, u&#39;Height&#39;, u&#39;MRI_Count&#39;], dtype=&#39;object&#39;)</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="manipulating-data">
<h4>1.1.2.2. Manipulating data<a class="headerlink" href="#manipulating-data" title="Permalink to this headline">¶</a></h4>
<p><cite>data</cite> is a pandas dataframe, that resembles R&#8217;s dataframe:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;Gender&#39;</span><span class="p">]</span>  
<div class="newline"></div><span class="go">0     Female</span>
<div class="newline"></div><span class="go">1       Male</span>
<div class="newline"></div><span class="go">2       Male</span>
<div class="newline"></div><span class="go">3       Male</span>
<div class="newline"></div><span class="go">4     Female</span>
<div class="newline"></div><span class="gp">...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">gender_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">&#39;Gender&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">gender_data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="go">        Unnamed: 0   FSIQ     VIQ     PIQ      Weight     Height  MRI_Count</span>
<div class="newline"></div><span class="go">Gender</span>
<div class="newline"></div><span class="go">Female       19.65  111.9  109.45  110.45  137.200000  65.765000   862654.6</span>
<div class="newline"></div><span class="go">Male         21.35  115.0  115.25  111.60  166.444444  71.431579   954855.4</span>
<div class="newline"></div>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c"># More manual, but more versatile</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">gender_data</span><span class="p">[</span><span class="s">&#39;VIQ&#39;</span><span class="p">]:</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">print</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="go">Female 109.45</span>
<div class="newline"></div><span class="go">Male 115.25</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c"># Simpler selector</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;Female&#39;</span><span class="p">][</span><span class="s">&#39;VIQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="go">109.45</span>
<div class="newline"></div></pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_pandas.html"><img alt="_images/plot_pandas_1.png" class="align-right" src="_images/plot_pandas_1.png" style="width: 320.0px; height: 240.0px;" /></a>
<div class="green topic">
<p class="topic-title first"><strong>Exercise</strong></p>
<ul>
<li><p class="first">What is the mean value for VIQ for the full population?</p>
</li>
<li><p class="first">How many males/females were included in this study?</p>
<p><strong>Hint</strong> use &#8216;tab completion&#8217; to find out the methods that can be
called, instead of &#8216;mean&#8217; in the above example.</p>
</li>
<li><p class="first">What is the average value of MRI counts expressed in log units, for
males and females?</p>
</li>
</ul>
</div>
</div>
<div class="section" id="plotting-data">
<h4>1.1.2.3. Plotting data<a class="headerlink" href="#plotting-data" title="Permalink to this headline">¶</a></h4>
<p>Pandas comes with some plotting tools (that use matplotlib behind the
scene) to display statistics on dataframes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pandas.tools</span> <span class="kn">import</span> <span class="n">plotting</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s">&#39;Weight&#39;</span><span class="p">,</span> <span class="s">&#39;Height&#39;</span><span class="p">,</span> <span class="s">&#39;MRI_Count&#39;</span><span class="p">]])</span>   
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_pandas.html"><img alt="_images/plot_pandas_2.png" class="align-center" src="_images/plot_pandas_2.png" style="width: 400.0px; height: 300.0px;" /></a>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s">&#39;PIQ&#39;</span><span class="p">,</span> <span class="s">&#39;VIQ&#39;</span><span class="p">,</span> <span class="s">&#39;FSIQ&#39;</span><span class="p">]])</span>   
<div class="newline"></div></pre></div>
</div>
<div class="sidebar">
<p class="first sidebar-title"><strong>Two populations</strong></p>
<p class="last">The IQ metrics are bimodal. It looks like there are 2 sub-populations.
We will come back to this hypothesis.</p>
</div>
<a class="reference external image-reference" href="auto_examples/plot_pandas.html"><img alt="_images/plot_pandas_3.png" class="align-center" src="_images/plot_pandas_3.png" style="width: 400.0px; height: 300.0px;" /></a>
<div class="green topic">
<p class="topic-title first"><strong>Exercise</strong></p>
<p>Plot the scatter matrix for males only, and for females only. Do you
think that the 2 sub-populations correspond to gender?</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="hypothesis-testing-two-group-comparisons">
<h2><a class="toc-backref" href="#id3">1.2. Hypothesis testing: two-group comparisons</a><a class="headerlink" href="#hypothesis-testing-two-group-comparisons" title="Permalink to this headline">¶</a></h2>
<p>For simple statistical tests, we will use the <cite>stats</cite> sub-module of
<a class="reference external" href="http://docs.scipy.org/doc/">scipy</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Scipy is a vast library. For a tutorial covering the whole scope of
scipy, see <a class="reference external" href="http://scipy-lectures.github.io/">http://scipy-lectures.github.io/</a></p>
</div>
<div class="section" id="student-s-t-test">
<h3>1.2.1. Student&#8217;s t-test<a class="headerlink" href="#student-s-t-test" title="Permalink to this headline">¶</a></h3>
<div class="section" id="sample-t-test">
<h4>1.2.1.1. 1-sample t-test<a class="headerlink" href="#sample-t-test" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_1samp.html#scipy.stats.ttest_1samp" title="(in SciPy v0.16.0)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.stats.ttest_1samp()</span></tt></a> tests if observations are drawn from a
Gaussian distributions of given population mean. It returns the T
statistic, and the p-value (see the function&#8217;s help):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;VIQ&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>   
<div class="newline"></div><span class="go">(array(30.088099970...), 1.32891964...e-28)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">With a p-value of 10^-28 we can claim that the population mean for
the IQ (VIQ measure) is not 0.</p>
</div>
<a class="reference internal image-reference" href="_images/two_sided.png"><img alt="_images/two_sided.png" class="align-right" src="_images/two_sided.png" style="width: 228.5px; height: 223.5px;" /></a>
<div class="green topic">
<p class="topic-title first"><strong>Exercise</strong></p>
<p>Is the test performed above one-sided or two-sided? Which one should
we use, and what is the corresponding p-value?</p>
</div>
</div>
<div class="section" id="id1">
<h4>1.2.1.2. 2-sample t-test<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>We have seen above that the mean VIQ in the male and female populations
were different. To test if this is significant, we do a 2-sample t-test
with <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html#scipy.stats.ttest_ind" title="(in SciPy v0.16.0)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.stats.ttest_ind()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">female_viq</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;Female&#39;</span><span class="p">][</span><span class="s">&#39;VIQ&#39;</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">male_viq</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;Male&#39;</span><span class="p">][</span><span class="s">&#39;VIQ&#39;</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">female_viq</span><span class="p">,</span> <span class="n">male_viq</span><span class="p">)</span>   
<div class="newline"></div><span class="go">(array(-0.77261617232...), 0.4445287677858...)</span>
<div class="newline"></div></pre></div>
</div>
</div>
</div>
<div class="section" id="paired-tests">
<h3>1.2.2. Paired tests<a class="headerlink" href="#paired-tests" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="auto_examples/plot_pandas.html"><img alt="_images/plot_pandas_4.png" class="align-right" src="_images/plot_pandas_4.png" style="width: 280.0px; height: 210.0px;" /></a>
<p>PIQ, VIQ, and FSIQ give 3 measures of IQ. Let us test if FISQ and PIQ are
significantly different. We need to use a 2 sample test:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;PIQ&#39;</span><span class="p">])</span>   
<div class="newline"></div><span class="go">(array(0.46563759638...), 0.64277250...)</span>
<div class="newline"></div></pre></div>
</div>
<p>The problem with this approach is that is forgets that there are links
between observations: FSIQ and PIQ are measure on the same individuals.
Thus the variance due to inter-subject variability is confounding, and
can be removed, using a &#8220;paired test&#8221;, or &#8220;repeated measure test&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;PIQ&#39;</span><span class="p">])</span>   
<div class="newline"></div><span class="go">(array(1.784201940...), 0.082172638183...)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_pandas.html"><img alt="_images/plot_pandas_5.png" class="align-right" src="_images/plot_pandas_5.png" style="width: 240.0px; height: 180.0px;" /></a>
<p>This is equivalent to a 1-sample test on the difference:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;FSIQ&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;PIQ&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>   
<div class="newline"></div><span class="go">(array(1.784201940...), 0.082172638...)</span>
<div class="newline"></div></pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>T-tests assume Gaussian errors. We
can use a <a class="reference external" href="http://en.wikipedia.org/wiki/Wilcoxon_signed-rank_test">Wilcoxon signed-rank test</a>, that relaxes
this assumption:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;PIQ&#39;</span><span class="p">])</span>   
<div class="newline"></div><span class="go">(274.5, 0.106594927...)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The corresponding test in the non paired case is the <a class="reference external" href="http://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U">Mann–Whitney U
test</a>,
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.mannwhitneyu.html#scipy.stats.mannwhitneyu" title="(in SciPy v0.16.0)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.stats.mannwhitneyu()</span></tt></a>.</p>
</div>
<div class="green topic">
<p class="topic-title first"><strong>Exercice</strong></p>
<ul class="simple">
<li>Test the difference between weights in males and females.</li>
<li>Use non parametric statistics to test the difference between VIQ in
males and females.</li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="linear-models-anova">
<h2><a class="toc-backref" href="#id4">1.3. Linear models, ANOVA</a><a class="headerlink" href="#linear-models-anova" title="Permalink to this headline">¶</a></h2>
<div class="section" id="a-simple-linear-regression">
<h3>1.3.1. A simple linear regression<a class="headerlink" href="#a-simple-linear-regression" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="auto_examples/plot_regression.html"><img alt="_images/plot_regression_1.png" class="align-right" src="_images/plot_regression_1.png" style="width: 300.0px; height: 240.0px;" /></a>
<p>Given two set of observations, <cite>x</cite> and <cite>y</cite>, we want to test the
hypothesis that <cite>y</cite> is a linear function of <cite>x</cite>. In other terms:</p>
<blockquote>
<div><img class="math" src="_images/math/bc58ea9036de1e62198871a091359876bff43a5b.png" alt="y = x * coef + intercept + e" style="vertical-align: -6px"/></div></blockquote>
<p>where <cite>e</cite> is observation noise. We will use the <a class="reference external" href="http://statsmodels.sourceforge.net/">statmodels</a> module to:</p>
<ol class="arabic simple">
<li>Fit a linear model. We will use the simplest strategy, <a class="reference external" href="http://en.wikipedia.org/wiki/Ordinary_least_squares">ordinary least
squares</a> (OLS).</li>
<li>Test that <cite>coef</cite> is non zero.</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>First, we generate simulated data according to the model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c"># normal distributed noise</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c"># Create a data frame containing all the relevant variables</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
<div class="newline"></div></pre></div>
</div>
<p>Specify an OLS model and fit it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># The following will work only with a recent version of statsmodels</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s">&quot;y ~ x&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>  
<div class="newline"></div><span class="go">                            OLS Regression Results</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div><span class="go">Dep. Variable:                      y   R-squared:                       0.804</span>
<div class="newline"></div><span class="go">Model:                            OLS   Adj. R-squared:                  0.794</span>
<div class="newline"></div><span class="go">Method:                 Least Squares   F-statistic:                     74.03</span>
<div class="newline"></div><span class="go">Date:                ...                Prob (F-statistic):           8.56e-08</span>
<div class="newline"></div><span class="go">Time:                        ...        Log-Likelihood:                -57.988</span>
<div class="newline"></div><span class="go">No. Observations:                  20   AIC:                             120.0</span>
<div class="newline"></div><span class="go">Df Residuals:                      18   BIC:                             122.0</span>
<div class="newline"></div><span class="go">Df Model:                           1</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div><span class="go">                 coef    std err          t      P&gt;|t|      [95.0% Conf. Int.]</span>
<div class="newline"></div><span class="go">------------------------------------------------------------------------------</span>
<div class="newline"></div><span class="go">Intercept     -5.5335      1.036     -5.342      0.000        -7.710    -3.357</span>
<div class="newline"></div><span class="go">x              2.9369      0.341      8.604      0.000         2.220     3.654</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div><span class="go">Omnibus:                        0.100   Durbin-Watson:                   2.956</span>
<div class="newline"></div><span class="go">Prob(Omnibus):                  0.951   Jarque-Bera (JB):                0.322</span>
<div class="newline"></div><span class="go">Skew:                          -0.058   Prob(JB):                        0.851</span>
<div class="newline"></div><span class="go">Kurtosis:                       2.390   Cond. No.                         3.03</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div></pre></div>
</div>
<div class="green topic">
<p class="topic-title first"><strong>Exercise</strong></p>
<p>Retrieve the estimated parameters from the model above. <strong>Hint</strong>:
use tab-completion to find the relevent attribute.</p>
</div>
</div>
<div class="section" id="multiple-regression">
<h3>1.3.2. Multiple Regression<a class="headerlink" href="#multiple-regression" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="auto_examples/plot_regression_3d.html"><img alt="_images/plot_regression_3d_1.png" class="align-right" src="_images/plot_regression_3d_1.png" style="width: 360.0px; height: 270.0px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Consider a linear model explaining a variable <cite>z</cite> (the dependent
variable) with 2 variables <cite>x</cite> and <cite>y</cite>:</p>
<blockquote>
<div><img class="math" src="_images/math/cddc472fb39acbaeda699510793607c1defe17b2.png" alt="z = x \, c_1 + y \, c_2 + i + e" style="vertical-align: -6px"/></div></blockquote>
<p>Such a model can be seen in 3D as fitting a plane to a cloud of (<cite>x</cite>,
<cite>y</cite>, <cite>z</cite>) points.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>Example: the iris data</strong></p>
<a class="reference external image-reference" href="auto_examples/plot_iris_analysis_1.html"><img alt="_images/plot_iris_analysis_1.png" class="align-center" src="_images/plot_iris_analysis_1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">&#39;examples/iris.csv&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s">&#39;sepal_width ~ name + petal_length&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>  
<div class="newline"></div><span class="go">                            OLS Regression Results</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div><span class="go">Dep. Variable:            sepal_width   R-squared:                       0.478</span>
<div class="newline"></div><span class="go">Model:                            OLS   Adj. R-squared:                  0.468</span>
<div class="newline"></div><span class="go">Method:                 Least Squares   F-statistic:                     44.63</span>
<div class="newline"></div><span class="go">Date:                ...                Prob (F-statistic):           1.58e-20</span>
<div class="newline"></div><span class="go">Time:                        ...        Log-Likelihood:                -38.185</span>
<div class="newline"></div><span class="go">No. Observations:                 150   AIC:                             84.37</span>
<div class="newline"></div><span class="go">Df Residuals:                     146   BIC:                             96.41</span>
<div class="newline"></div><span class="go">Df Model:                           3</span>
<div class="newline"></div><span class="go">===============================================================================...</span>
<div class="newline"></div><span class="go">                         coef    std err          t     P&gt;|t|  [95.0% Conf. Int.]</span>
<div class="newline"></div><span class="go">-------------------------------------------------------------------------------...</span>
<div class="newline"></div><span class="go">Intercept              2.9813      0.099     29.989     0.000      2.785     3.178</span>
<div class="newline"></div><span class="go">name[T.versicolor]    -1.4821      0.181     -8.190     0.000     -1.840    -1.124</span>
<div class="newline"></div><span class="go">name[T.virginica]     -1.6635      0.256     -6.502     0.000     -2.169    -1.158</span>
<div class="newline"></div><span class="go">petal_length           0.2983      0.061      4.920     0.000      0.178     0.418</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div><span class="go">Omnibus:                        2.868   Durbin-Watson:                   1.753</span>
<div class="newline"></div><span class="go">Prob(Omnibus):                  0.238   Jarque-Bera (JB):                2.885</span>
<div class="newline"></div><span class="go">Skew:                          -0.082   Prob(JB):                        0.236</span>
<div class="newline"></div><span class="go">Kurtosis:                       3.659   Cond. No.                         54.0</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="post-hoc-anova-contrast-vectors">
<h3>1.3.3. Post-hoc ANOVA: contrast vectors<a class="headerlink" href="#post-hoc-anova-contrast-vectors" title="Permalink to this headline">¶</a></h3>
<p>In the above iris example, we wish to test if the petal length is
different between versicolor and virginica, after removing the effect of
sepal width. This can be formulated as testing the difference between the
coefficient associated to versicolor and virginica in the linear model
estimated above (it is an Analysis of Variance, ANOVA). For this, we
write a vector of &#8216;contrast&#8217; on the parameters estimated: we want to test
&#8220;name[T.versicolor] - name[T.virginica]&#8221;, with an &#8216;F-test&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">f_test</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<div class="newline"></div><span class="go">&lt;F test: F=array([[ 3.24533535]]), p=[[ 0.07369059]], df_denom=146, df_num=1&gt;</span>
<div class="newline"></div></pre></div>
</div>
<p>Is this difference significant?</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="green topic">
<p class="topic-title first"><strong>Exercice</strong></p>
<p>Going back to the brain size + IQ data, test if the VIQ of male and
female are different after removing the effect of brain size, height
and weight.</p>
</div>
<p><div style="clear: both"></div></p>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="auto_examples/index.html" title="2. Examples"
             >next</a></li>
        <li class="right" >
          <a href="index.html" title="Statistics in Python"
             >previous</a> |</li>
        <li><a href="index.html">Statistics in Python</a> &raquo;</li>
     
    <!-- Insert a menu in the navigation bar -->
    <li class="left">
	<!-- On click toggle the 'tip' on or off-->
	<a onclick="$('.tip').each(function (index, obj) {
			    collapse_tip_div(obj);
		    });
		    $('.tip').addClass('collapsed');
		    $('.left').addClass('transparent');">
	<img src="_static/minus.png"
         alt="Collapse to compact view" style="padding: 1ex;"/>
	<span class="hiddenlink">Collapse document to compact view</span>
    </a></li>

      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012,2013,2014,2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>